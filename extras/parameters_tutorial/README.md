# Tutorial on using XSLT parameters in RENDER_STYLESHEETs

As explained in this module's main README, if a collection object has a datastream with an ID of 'RENDER_STYLESHEET', the XSLT transform in that datastream is applied to all XML objects that are members of the collection, unless a member object has its own RENDER_STYLESHEET datastream. In addition, parameters can be passed to the RENDER_STYLESHEET via URL query parameters, as long as the parameters are declared in the stylesheet; for example, `http://host/islandora/object/islandora:29?foo=true&bar=Mark` would make the values of `foo` and `bar` accessible in the stylesheet as follows:

```xml
  <xsl:param name="foo"></xsl:param>
  <xsl:param name="bar"></xsl:param>

  <xsl:if test="$foo='true' and $bar">
    <div>Hello <span><xsl:value-of select="$bar"/></span></div>
  </xsl:if>
```

The parameter 'pid' is always passed to the stylesheet, providing writers of RENDER_STYLESHEETs with access to the current object's PID, which is useful in generating URLs within the document.

This tutorial illustrates how URL parameters passed to a RENDER_STYLESHEET can be used to transform a single XML object, namely an excerpt of Cory Doctorow's **Down and Out in the Magic Kingdom** marked up in DocBook, in a variety of ways. Doctorow's text is used here under a Creative Commons [Attribution-NonCommercial-ShareAlike 1.0 Generic](https://creativecommons.org/licenses/by-nc-sa/1.0/) license.

To see in action what is described below, create an object with the Islandora XML content model using the `downandout_docbook.xml` file as the object's OBJ datastream and the `RENDER_STYLESHEET.xsl` file as the RENDER_STYLESHEET datastream.

## Rendering the table of contents

Constructing a simple table of contents using the source XML document's chapter titles is the default behavior when viewing the XML object. The logic within the stylesheet is that if the 'chapter' parameter is not present (in other words, the Islandora URL is the same as the one normally generated by Islandora when a user views an object), perform the following transform for each `<docbook:chapter>` element within the template:

```xml
   <xsl:if test="not($chapter)">
     <p><a href="/islandora/object/{$pid}?chapter={./@xml:id}"><xsl:value-of select="docbook:title"/></a></p>
   </xsl:if>
```

The result is HTML output that contains a link for each chapter title, each one containing the chapter's `xml:id` attribute value as a URL parameter.

## Rendering a specific chapter

If the 'chapter' parameter is passed to the stylesheet, its value is used to determine which `<chapter>` node in the document to render to the user. The XSLT used to do this is:

```xml
   <xsl:if test="$chapter">
     <xsl:if test="./@xml:id=$chapter">
       <h2><xsl:value-of select="docbook:title"/></h2>
        <xsl:for-each select="docbook:para">
          <p><xsl:value-of select="."/></p>
        </xsl:for-each>
        <div><a href="/islandora/object/{$pid}">Table of contents</a></div>
     </xsl:if>
   </xsl:if>
```

The chapter;s `<title>` element, plus each of its `<para>` elements, are transformed into simple HTML markup. This XSLT also adds a link back to the table of contents (in other words, a link back to the object's standard URL).

## Rendering the entire document

If the 'chapter' parameter contains the reserved value 'all', the following XSLT is applied to each `<chapter>` node in the object's XML:

```xml
  <xsl:if test="$chapter='all'">
    <h2><xsl:value-of select="docbook:title"/></h2>
    <xsl:for-each select="docbook:para">
      <p><xsl:value-of select="."/></p>
    </xsl:for-each>
    <div><a href="/islandora/object/{$pid}">Table of contents</a></div>
  </xsl:if>
```
